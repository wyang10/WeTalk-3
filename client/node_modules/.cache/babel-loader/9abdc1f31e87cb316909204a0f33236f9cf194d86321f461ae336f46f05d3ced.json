{"ast":null,"code":"import _regeneratorRuntime from\"/Users/weihongyang/Desktop/WeTalk/version4/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/weihongyang/Desktop/WeTalk/version4/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/weihongyang/Desktop/WeTalk/version4/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'../css/HomePage.css';import{useEffect,useState}from\"react\";import{baseurl,getLoginUser}from\"../config\";import{TwitterItem}from\"../components/TwitterItem\";import{post}from\"../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export function HomePage(props){var user_id=props.user_id;if(user_id===undefined||user_id===null){var queryParameters=new URLSearchParams(window.location.search);user_id=queryParameters.get(\"id\");}var _useState=useState([]),_useState2=_slicedToArray(_useState,2),twitterList=_useState2[0],setTwitterList=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),content=_useState4[0],setContent=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isFollowed=_useState6[0],setFollowed=_useState6[1];function refresh(){post(\"\".concat(baseurl,\"/list_twitters\"),{username:user_id}).then(function(data){setTwitterList(data);});post(\"\".concat(baseurl,\"/is_followed\"),{from:getLoginUser(),to:user_id}).then(function(data){setFollowed(data.result);});}useEffect(function(){refresh();},[]);var toolbox=/*#__PURE__*/_jsxs(\"div\",{className:\"reply-box\",style:{marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"twitter-area\",onChange:function onChange(e){return setContent(e.target.value);},value:content}),/*#__PURE__*/_jsx(\"button\",{className:\"twitter-postbtn\",onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(content.length<5)){_context.next=3;break;}alert(\"The minimum length of twitter is 5\");return _context.abrupt(\"return\");case 3:_context.next=5;return post(\"\".concat(baseurl,\"/post_twitter\"),{username:user_id,content:content});case 5:refresh();setContent(\"\");case 7:case\"end\":return _context.stop();}}},_callee);})),children:\"Post a twitter\"})]});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:\"20px 10px\",display:\"inline-block\"},children:getLoginUser()===user_id?\"My Home Page\":\"@\".concat(user_id,\" 's Home Page\")}),/*#__PURE__*/_jsx(\"button\",{className:isFollowed?\"follow-btn-small1\":\"follow-btn-small2\",onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(isFollowed){_context2.next=5;break;}_context2.next=3;return post(\"\".concat(baseurl,\"/follow\"),{from:getLoginUser(),to:user_id});case 3:_context2.next=7;break;case 5:_context2.next=7;return post(\"\".concat(baseurl,\"/unfollow\"),{from:getLoginUser(),to:user_id});case 7:refresh();case 8:case\"end\":return _context2.stop();}}},_callee2);})),children:!isFollowed?\"Follow\":\"UnFollow\"})]}),getLoginUser()===user_id?toolbox:/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"follower-btn\",onClick:function onClick(){window.location=\"/following?id=\".concat(user_id);},children:\"Following/Followers\"}),twitterList.map(function(x,idx){return/*#__PURE__*/_jsx(TwitterItem,{twitter_item:x},x._id);})]});}","map":{"version":3,"names":["useEffect","useState","baseurl","getLoginUser","TwitterItem","post","HomePage","props","user_id","undefined","queryParameters","URLSearchParams","window","location","search","get","twitterList","setTwitterList","content","setContent","isFollowed","setFollowed","refresh","username","then","data","from","to","result","toolbox","marginBottom","e","target","value","length","alert","margin","display","map","x","idx","_id"],"sources":["/Users/weihongyang/Desktop/WeTalk/version4/client/src/pages/HomePage.js"],"sourcesContent":["import '../css/HomePage.css';\r\nimport {useEffect, useState} from \"react\";\r\nimport {baseurl, getLoginUser} from \"../config\";\r\nimport {TwitterItem} from \"../components/TwitterItem\";\r\nimport PropTypes from \"prop-types\";\r\nimport {post} from \"../utils\";\r\n\r\n\r\nexport function HomePage(props) {\r\n  let {user_id} = props\r\n  if (user_id === undefined || user_id === null) {\r\n    const queryParameters = new URLSearchParams(window.location.search)\r\n    user_id = queryParameters.get(\"id\")\r\n  }\r\n\r\n  let [twitterList, setTwitterList] = useState([])\r\n  let [content, setContent] = useState(\"\")\r\n  let [isFollowed, setFollowed] = useState(false)\r\n\r\n  function refresh() {\r\n    post(`${baseurl}/list_twitters`, {username: user_id}).then(data => {\r\n      setTwitterList(data)\r\n    })\r\n    post(`${baseurl}/is_followed`, {from: getLoginUser(), to: user_id}).then(data => {\r\n      setFollowed(data.result)\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    refresh()\r\n  }, [])\r\n\r\n\r\n  let toolbox = (<div className={\"reply-box\"} style={{marginBottom: \"10px\"}}>\r\n        <textarea className={\"twitter-area\"}\r\n                  onChange={(e) => setContent(e.target.value)} value={content}></textarea>\r\n      <button className={\"twitter-postbtn\"} onClick={async () => {\r\n        if (content.length < 5) {\r\n          alert(\"The minimum length of twitter is 5\")\r\n          return\r\n        }\r\n        await post(`${baseurl}/post_twitter`, {username: user_id, content: content})\r\n        refresh()\r\n        setContent(\"\")\r\n      }}>Post a twitter\r\n      </button>\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div>\r\n      <div>\r\n        <h2 style={{\r\n          margin: \"20px 10px\",\r\n          display: \"inline-block\",\r\n        }}>{getLoginUser() === user_id ? \"My Home Page\" : `@${user_id} 's Home Page`}</h2>\r\n        <button className={isFollowed ? \"follow-btn-small1\" : \"follow-btn-small2\"} onClick={async () => {\r\n          if (!isFollowed) {\r\n            await post(`${baseurl}/follow`, {from: getLoginUser(), to: user_id})\r\n          } else {\r\n            await post(`${baseurl}/unfollow`, {from: getLoginUser(), to: user_id})\r\n          }\r\n          refresh()\r\n        }}>{!isFollowed ? \"Follow\" : \"UnFollow\"}</button>\r\n      </div>\r\n      {getLoginUser() === user_id ? toolbox : <div></div>}\r\n      <button className={\"follower-btn\"} onClick={() => {\r\n        window.location = `/following?id=${user_id}`\r\n      }}>Following/Followers\r\n      </button>\r\n      {twitterList.map((x, idx) => <TwitterItem key={x._id} twitter_item={x}></TwitterItem>)}\r\n    </div>\r\n  )\r\n}\r\n\r\nHomePage.propTypes = {\r\n  user_id: PropTypes.string\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}